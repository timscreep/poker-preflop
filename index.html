<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <title>GTO Editor - Comfort Mode</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { 
            --bg: #0f172a; --panel: #1e293b; 
            --red: #ef4444; --green: #22c55e; --blue: #3b82f6; 
        }
        body { 
            background: var(--bg); color: #f8fafc; 
            font-family: system-ui, sans-serif; 
            height: 100vh; margin: 0; overflow: hidden; 
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }

        /* Удобный Слайдер */
        .slider-track {
            width: 100%; height: 44px; background: var(--blue); 
            border-radius: 12px; position: relative; border: 2px solid #334155;
            cursor: pointer; touch-action: none;
        }
        .bar-r { position: absolute; height: 100%; background: var(--red); border-radius: 10px 0 0 10px; }
        .bar-c { position: absolute; height: 100%; background: var(--green); }
        
        /* Крупные ползунки */
        .handle {
            position: absolute; width: 14px; height: 54px; 
            background: #ffffff; border: 3px solid #6366f1;
            top: -5px; border-radius: 6px; transform: translateX(-50%);
            z-index: 20; cursor: col-resize; box-shadow: 0 4px 10px rgba(0,0,0,0.5);
        }
        .handle:hover { border-color: #818cf8; scale: 1.05; }

        /* Матрица 13x13 */
        .matrix { display: grid; grid-template-columns: repeat(13, 1fr); gap: 2px; background: #334155; padding: 2px; border-radius: 8px; }
        .cell { 
            width: 40px; height: 40px; background: var(--blue); 
            position: relative; display: flex; align-items: center; justify-content: center;
            font-size: 11px; font-weight: 700; cursor: pointer; user-select: none;
        }
        .cell-bg { position: absolute; inset: 0; display: flex; flex-direction: column; pointer-events: none; }
        .cell-text { position: relative; z-index: 5; color: #000; pointer-events: none; }
    </style>
</head>
<body class="p-4">

    <div class="w-full max-w-[550px] bg-[#1e293b] p-6 rounded-2xl shadow-2xl border border-slate-700 mb-6">
        <div class="flex justify-between text-xs font-black uppercase tracking-widest mb-4">
            <span class="text-red-400">Raise: <span id="v-r" class="text-lg">30</span>%</span>
            <span class="text-green-400">Call: <span id="v-c" class="text-lg">40</span>%</span>
            <span class="text-blue-400">Fold: <span id="v-f" class="text-lg">30</span>%</span>
        </div>

        <div class="slider-track" id="s-root">
            <div class="bar-r" id="b-r" style="width: 30%;"></div>
            <div class="bar-c" id="b-c" style="left: 30%; width: 40%;"></div>
            <div class="handle" id="h1" style="left: 30%;"></div>
            <div class="handle" id="h2" style="left: 70%;"></div>
        </div>
        <p class="text-[10px] text-slate-400 mt-4 text-center uppercase font-bold tracking-tight">
            Двигайте ползунки и зажмите мышь, чтобы красить матрицу
        </p>
    </div>

    <div id="matrix" class="matrix shadow-2xl border border-slate-700"></div>

    <div class="flex gap-6 mt-6">
        <button onclick="rangeData={}; renderMatrix()" class="text-xs font-bold text-slate-400 hover:text-red-400 uppercase tracking-widest transition">Очистить всё</button>
        <button onclick="exportJSON()" class="bg-indigo-600 hover:bg-indigo-500 px-6 py-2 rounded-lg text-xs font-bold uppercase tracking-widest transition">Сохранить диапазон</button>
    </div>

<script>
    const RANKS = "AKQJT98765432".split("");
    let rangeData = {}; 
    let fR = 30, fC = 40; // Частоты Raise и Call (остальное Fold)

    // Элементы слайдера
    const h1 = document.getElementById('h1'), h2 = document.getElementById('h2'), sRoot = document.getElementById('s-root');
    const br = document.getElementById('b-r'), bc = document.getElementById('b-c');

    function updateSlider() {
        // Ограничения
        br.style.width = fR + '%';
        bc.style.left = fR + '%';
        bc.style.width = fC + '%';
        
        h1.style.left = fR + '%';
        h2.style.left = (fR + fC) + '%';

        document.getElementById('v-r').innerText = fR;
        document.getElementById('v-c').innerText = fC;
        document.getElementById('v-f').innerText = 100 - fR - fC;
    }

    function handleMove(e, index) {
        const rect = sRoot.getBoundingClientRect();
        let percent = Math.round(((e.clientX - rect.left) / rect.width) * 100);
        percent = Math.max(0, Math.min(100, percent));

        if (index === 1) { // Левый ползунок
            let total = fR + fC;
            fR = Math.min(percent, total);
            fC = total - fR;
        } else { // Правый ползунок
            fC = Math.max(0, percent - fR);
        }
        updateSlider();
    }

    [h1, h2].forEach((h, i) => {
        h.onmousedown = () => {
            const onMove = (e) => handleMove(e, i + 1);
            document.onmousemove = onMove;
            document.onmouseup = () => document.onmousemove = null;
        };
    });

    // Инициализация матрицы
    function initMatrix() {
        const container = document.getElementById('matrix');
        RANKS.forEach((r1, i) => {
            RANKS.forEach((r2, j) => {
                const combo = i < j ? r1+r2+'s' : (i > j ? r2+r1+'o' : r1+r2);
                const cell = document.createElement('div');
                cell.className = 'cell';
                cell.dataset.hand = combo;
                cell.innerHTML = `<div class="cell-bg"></div><div class="cell-text">${combo}</div>`;
                
                // Рисование при зажатой кнопке
                cell.onmousedown = () => paint(cell);
                cell.onmouseenter = (e) => { if(e.buttons === 1) paint(cell); };
                container.appendChild(cell);
            });
        });
        renderMatrix();
    }

    function paint(cell) {
        rangeData[cell.dataset.hand] = { r: fR, c: fC };
        renderMatrix();
    }

    function renderMatrix() {
        document.querySelectorAll('.cell').forEach(c => {
            const data = rangeData[c.dataset.hand] || { r: 0, c: 0 };
            c.querySelector('.cell-bg').innerHTML = `
                <div style="height:${data.r}%; background:var(--red)"></div>
                <div style="height:${data.c}%; background:var(--green)"></div>
                <div style="flex:1; background:var(--blue)"></div>
            `;
        });
    }

    function exportJSON() {
        const blob = new Blob([JSON.stringify(rangeData, null, 2)], {type : 'application/json'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href = url; a.download = 'range.json'; a.click();
    }

    initMatrix();
    updateSlider();
</script>
</body>
</html>
